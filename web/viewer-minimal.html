<!DOCTYPE html>
<html>
<!--

== OpenJSCAD.org, Copyright (c) 2016-2017, Licensed under MIT License ==
   in conjunction with other libraries by various authors (see the individual files)

Purpose:
  This application provides an example of how to show JSCAD designs with minimal HTML and CSS.
-->
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
  <title>OpenJSCAD.org Logo</title>
  <link rel="stylesheet" href="min.css" type="text/css">
  <!-- <link rel="stylesheet" type="text/css" href="css/main.css"> -->
  <link rel="stylesheet" href="bootstrap.min.css" type="text/css">
  <script src="min.js"></script>
</head>
<body>
  <div class="main-content">
    <div id="header" class="col-12">
        <!-- <h2 class="text-light text-left align-middle"> Structure Damage Identification and Diagnosis System </h1>  -->
        <img src="./images/title.png" class="rounded float-left" alt=""> 
    </div>
    <div id="content" class="container-fluid">
      <div class="row">
        <div id="jscad-container" class="col-5 jscad-container">
          <div oncontextmenu="return false;" id="viewerContext" design-url="storey-options.jscad"></div> 
        </div>
        <div id="control-container" class="col-2 order-first scrollbar-ripe-malinka sidebar">
          <div class="col-12 strike text-muted" id="modelcontrol">
            <span> 模 型 </span>
          </div>
          <div class="form-group row">
            <label for="modeltype" class="col-sm-5 col-form-label text-left">计算模型</label>
            <div class="col-sm-7">
              <select class="form-control" id="modeltype">
                <option value=""></option>
                <option value="1">剪切层</option>
                <option value="2">悬臂梁</option>
              </select> 
            </div>
          </div>
          <div class="col-12 strike text-muted" id="parametercontrol">
            <span> 参 数 </span>
          </div>
          <div class="form-group row">
            <label for="selectbtn" class="col-sm-5 col-form-label text-left">选择数据</label>
            <div class="col-sm-7">
              <span>
                <button type="submit" class="btn btn-primary" value="getdatafile" id="selectbtn">
                  Select
                </button>
              </span>
              <span class="submitWord">未选择数据。</span>
            </div>
          </div>
          <div class="form-group row">
            <label for="effdof" class="col-sm-5 col-form-label text-left">测点编号</label>
            <div class="col-sm-7">
              <input type="text" class="form-control" id="effdof", value="[8]">
            </div>
          </div>
          <div class="form-group row">
            <label for="orderuse" class="col-sm-5 col-form-label text-left">数据阶数</label>
            <div class="col-sm-7">
              <input type="text" class="form-control" id="orderuse", value="[1,2,3,4,5,6,7]">
            </div>
          </div>
          <div class="form-group row">
            <label for="tol" class="col-sm-5 col-form-label text-left">收敛因子</label>
            <div class="col-sm-7">
              <input type="text" class="form-control" id="tol", value="1.0e-6">
            </div>
          </div>
          <div class="form-group row">
            <label for="nmax" class="col-sm-5 col-form-label text-left">最大迭代步数</label>
            <div class="col-sm-7">
              <input type="text" class="form-control" id="nmax", value="1000">
            </div>
          </div>
          <div class="form-group row">
            <label for="goaltype" class="col-sm-5 col-form-label text-left">目标函数类型</label>
            <div class="col-sm-7">
              <select class="form-control" id="goaltype">
                <option>解耦型</option>
                <option>耦合型</option>
              </select> 
            </div>
          </div>
          <div class="form-group row">
            <label for="regform" class="col-sm-4 col-form-label text-left">正则化</label>
            <div class="col-sm-8">
              <div id="regform">
                <div class="custom-control custom-radio mb-1">
                  <input type="radio" id="L1reg" name="regularization" class="custom-control-input regularization" value="L1" checked>
                  <label class="custom-control-label" for="L1reg">L-1 (默认)</label>
                </div>
                    <div class="row reg-group" id="L1-reg-group" >
                  <div class="col-md-6 form-group">
                    <strong class="text-muted mb-1">
                      <label for="alpha">&#945;</label>
                    </strong>
                    <input type="number" class="form-control" name="L1-alpha" id="L1-alpha" value="10"> 
                  </div>
                  <div class="col-md-6 form-group">
                    <strong class="text-muted mb-1">
                      <label for="lmax">L-max</label>
                    </strong>
                    <input type="number" class="form-control" name="L1-lmax" id="L1-lmax" value="3">    
                  </div>            
                </div>

                <div class="custom-control custom-radio mb-1">
                  <input type="radio"  id="L2reg"  name="regularization" class="custom-control-input regularization" value="L2">
                  <label class="custom-control-label"  for="L2reg">L-2 </label>
                </div>
                <div class="custom-control custom-radio mb-1">
                  <input type="radio" id="noreg" name="regularization" class="custom-control-input regularization" value="">
                  <label class="custom-control-label" for="noreg">不采用正则化 </label>
                </div>                
              </div>
            </div>
          </div>

<!--           <div class="col-md-6 form-group">
            <strong class="text-muted mb-1">
              <label for="modeltype">模型类型</label>           
            </strong>
            <select class="form-control" id="modeltype">
              <option>剪切层</option>
              <option>悬臂梁</option>
            </select>   
          </div> 
          <div class="col-md-6 form-group">
            <strong class="text-muted mb-1">
              <label for="goaltype">目标函数类型</label>
            </strong>
            <select class="form-control" id="goaltype">
              <option>解耦型</option>
              <option>耦合型</option>
            </select>   
          </div> -->

          <div class="col-sm-12 p-2">
            <button class="btn btn-primary btn-block" id="Calculate">
              计算损伤
            </button>  
          </div>
        </div>
        <div id="result-container" class="col-4 order-last">
          <div id="tail" style="display: none;">
            <div id="statusdiv"></div>
          </div>
        </div>     
      </div>
    </div>
  </div>
</body>
<script src="js/jquery-3.4.1.min.js"></script>
<script>
  // 检查类型是radio(type="radio"),属于regularization类(class="regularization")的input标签
  // 有没有被选中(checked)，没有被选中的话让它父元素的下一个属于reg-group类(class="reg-group")的
  // div 标签隐藏。
  $("input.regularization:radio:not(:checked)").parent().next('div.reg-group').hide();
  // 检查类型是radio(type="radio"),属于regularization类(class="regularization")的input标签
  // 是不是在变化，如果有变化，则判断变化的这个(this)标签是否被选中(checked)了，如果选中了，则让
  // 这个标签(this)的父元素的下一个属于reg-group类(class="reg-group")的div标签显示出来，并将其他
  // 除了这个标签外的，类型是radio(type="radio"),属于regularization类(class="regularization")
  // 的input标签的父元素的下一个属于reg-group类(class="reg-group")的div标签隐藏。
  $("input.regularization:radio").change(function () {
    if ($(this).is(':checked')) {
      $(this).parent().next('div.reg-group').show();
      $('input.regularization:radio').not(this).parent().next('div.reg-group').hide();
    }
  });
  var cachebuster = null;

  function reload_openjscad() {
      if (cachebuster === null) {
        $('script[src="min.js"]').remove();
      } else {
        $('script[src="min.js?cachebuster='+ cachebuster +'"]').remove();  
      }
      cachebuster = new Date().getTime();
      $('<script>').attr('src', 'min.js?cachebuster='+ cachebuster).appendTo('head');
  }

  $(document).ready(
    $("#modeltype").change(function(){
      if ($(this).val() == 1){
        console.log('footer first!');
        $("#viewerContext").attr('design-url', 'storey-options.jscad');
        // reload_openjscad();
      }
      if ($(this).val() == 2){
        console.log('footer first!');
        $("#viewerContext").attr('design-url', 'beam3D.jscad');
        // reload_openjscad();
      };
    })
  )
//   document.getElementById('modeltype').addEventListener('change', function (event) {
//   init();
// });

</script>
</html>
